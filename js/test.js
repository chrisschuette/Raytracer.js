    i += u * ( max(0, k / sqrt(dot(L, L)*n)) + 
      /*max(0, math.pow( dot(M = A_minus_Bk(L, N, 2*k/n), D) / sqrt(dot(M, M)*dot(D, D)), spheres[s+4])) */);